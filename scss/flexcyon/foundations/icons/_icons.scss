// The code snippets in this file are derived from the Halcyon theme
// - https://github.com/dbarenholz/halcyon-obsidian?tab=readme-ov-file

body {
  --icon-xs: 12.25px;
  --dimmed: 0.55;
  --upsize: 103%;
  --expand: 110%;
  --less-letter-spacing: -3px;
  --flexcyon-comm-item-opacity: 0.89;
  --flexcyon-tree-item-horiz-padding: 10px;
  --flexcyon-tree-item-verti-padding: 2px;
  --flexcyon-comm-text-padding: 3px 16px;
  --icon-stroke: 2px;
  --icon-color-active: var(--interactive-accent);
  --icon-color-focused: var(--interactive-accent);
  --clickable-icon-radius: 0;

  .clickable-icon {
    opacity: var(--dimmed);
    padding: 4px 8px;

    &:hover {
      opacity: unset;
      scale: var(--upsize);
    }
  }

  .view-header-nav-buttons .clickable-icon,
  .view-actions .clickable-icon {
    padding: 5px 10px;
  }

  .modal-title {
    padding-block-end: 16px;
  }

  .graph-controls .clickable-icon,
  .clickable-icon.side-dock-ribbon-action {
    padding: var(--size-2-2) var(--size-2-3);
  }

  .mod-community-modal .modal-sidebar .setting-item.mod-toggle {
    padding: 6px 16px;
  }

  .mod-community-modal
    .modal-sidebar:not(:has(+ .community-modal-details))
    .setting-item.mod-toggle {
    margin-block-start: -8px;
  }

  .modal-sidebar {
    padding: 16px 8px;
  }

  .community-modal-search-summary {
    padding: 6px 16px;
    margin-inline-start: 4px;
  }

  .community-modal-search-results {
    padding: 16px;
    gap: 14px;
  }

  .community-modal-info hr {
    display: none;
  }

  .setting-item {
    border-block-start: none;
  }

  .setting-item.setting-item-heading {
    border-block-end: 1px solid var(--background-modifier-border);

    .setting-item-name {
      line-height: 1.5;
      padding-inline-end: 4px;
    }
  }

  .setting-item + div > .setting-item-heading,
  .setting-item + .setting-item-heading {
    margin-block-start: 1.5em;
  }

  .horizontal-tab-nav-item,
  .vertical-tab-nav-item {
    padding: calc(var(--size-4-1) + 1px) var(--size-4-2);
    margin-block-end: 1px;
    font-size: calc(var(--font-ui-small) + 1.25px);
  }

  .LazyLoad.is-visible {
    block-size: unset !important;
  }

  .oz-folder-line,
  .oz-nav-file,
  .tree-item:not(.graph-control-section) {
    padding: var(--flexcyon-tree-item-verti-padding)
      var(--flexcyon-tree-item-horiz-padding);
  }

  .text-snippets-class > * {
    inline-size: min(50em, 50vw);
  }

  .text-snippets-class > * > textarea {
    inline-size: min(30em, 35vw);
    margin-block: 16px;
  }

  [aria-label^="Collapse results"] {
    letter-spacing: var(--less-letter-spacing);
  }

  span.flair.mod-pop {
    margin-inline-start: var(--flexcyon-settings-installed-tooltip-left-margin);
  }
}

@media screen and (width < 900px) {
  div.setting-item {
    flex-direction: column;
    align-items: unset;

    .setting-item-control {
      align-items: unset;
      justify-content: unset;
    }
  }

  .text-snippets-class > * {
    inline-size: 50%;
    block-size: max-content;
  }

  .text-snippets-class > * > textarea {
    inline-size: 50%;
    block-size: 100px;
  }
}

body.flexcyon-workspace-card-layout {
  .community-modal-info-name {
    border: 2px solid var(--text-faint);
    border-start-start-radius: 16px;
    border-start-end-radius: 16px;
    border-block-end: 0;
    padding: var(--flexcyon-comm-text-padding);
    padding-block-start: 16px;
    margin-block: 8px 0;
  }

  .community-modal-info-downloads,
  .community-modal-info-version,
  .community-modal-info-author,
  .community-modal-info-repo,
  .community-modal-info-desc {
    border: 2px solid var(--text-faint);
    border-block-start: 0;
    border-block-end: 0;
    padding: var(--flexcyon-comm-text-padding);
    overflow-wrap: break-word;
  }

  .community-modal-info-desc {
    margin-block-start: 0;
  }

  .community-modal-info-downloads {
    inline-size: 100%;
    margin-block-start: 0;
  }

  .community-modal-button-container {
    border: 2px solid var(--text-faint);
    border-end-start-radius: 16px;
    border-end-end-radius: 16px;
    border-block-start: 0;
    padding: 16px;
    padding-block-end: 24px;
    margin: 0;
  }

  .community-modal-readme {
    margin-block-start: 32px;
  }
}

body.flexcyon-settings-comm-item-enabled {
  div.community-modal-search-results div.community-item {
    opacity: var(--flexcyon-comm-item-opacity);
  }

  div.community-modal-search-results div.community-item.is-selected {
    opacity: unset;
    border: unset;
    font-weight: bold;
  }

  div.community-item div.community-item-name span.flair.mod-pop {
    position: absolute;
    inset-inline-end: 0.5rem;
    inset-block-start: 0.7rem;
    background-color: var(--text-accent);
    color: var(--color-base-25);
  }

  div.community-item.is-selected div.community-item-name span.flair.mod-pop {
    background-color: var(--color-base-25);
    color: var(--text-normal);
  }

  .community-item-name {
    inline-size: 75%;
    overflow-wrap: break-word;
    color: var(--color-blue);
  }

  .community-item-downloads,
  .community-modal-info-downloads {
    color: rgba(var(--color-cyan-rgb), var(--flexcyon-comm-item-opacity));
  }

  .community-item-updated {
    color: rgba(
      var(--color-blue-rgb),
      calc(var(--flexcyon-comm-item-opacity) - 0.1)
    );
  }

  .community-modal-info-version {
    color: rgba(
      var(--color-green-rgb),
      calc(var(--flexcyon-comm-item-opacity) - 0.1)
    );
  }
}

body.theme-light.flexcyon-flex-max-mode:not(.is-phone),
body.theme-light.flexcyon-settings-comm-item-enabled:not(.is-phone) {
  .community-item.is-selected {
    background-color: var(--background-primary);
    border: none;

    span.flair.mod-pop {
      background-color: rgba(var(--color-blue-rgb), var(--dimmed));
    }

    .community-item-name {
      color: var(--color-red);
      font-weight: bold;
    }

    .community-item-author {
      color: var(--color-yellow);
      font-weight: bold;
    }

    .community-item-downloads {
      color: var(--color-purple);
      font-weight: bold;
    }

    .community-item-updated {
      color: var(--color-green);
      font-weight: bold;
    }

    .community-item-desc {
      color: var(--text-normal);
    }
  }
}

body.theme-dark.flexcyon-flex-max-mode:not(.is-phone),
body.theme-dark.flexcyon-settings-comm-item-enabled:not(.is-phone) {
  .community-item.is-selected {
    background-color: var(--background-primary);
    border: none;

    span.flair.mod-pop {
      background-color: rgba(var(--color-yellow-rgb), var(--dimmed));
    }

    .community-item-name {
      color: var(--color-red);
      font-weight: bold;
    }

    .community-item-author {
      color: var(--color-blue);
      font-weight: bold;
    }

    .community-item-downloads {
      color: var(--color-pink);
      font-weight: bold;
    }

    .community-item-updated {
      color: var(--color-purple);
      font-weight: bold;
    }

    .community-item-desc {
      color: var(--text-normal);
    }
  }
}

body.theme-light.flexcyon-flex-max-mode:not([class*="iconic"]),
body.theme-light.flexcyon-settings-smiley-icons-enabled.flexcyon-ensure-plugin-icon:not(
    [class*="iconic"]
  ),
body.theme-light.flexcyon-settings-smiley-icons-enabled:not(
    .flexcyon-ensure-plugin-icon
  ) {
  div.setting-item-control {
    div.checkbox-container::after {
      filter: saturate(2.5);
      font-weight: bold;
    }
  }
}

body.flexcyon-flex-max-mode:not([class*="iconic"]),
body.flexcyon-settings-smiley-icons-enabled.flexcyon-ensure-plugin-icon:not(
    [class*="iconic"]
  ),
body.flexcyon-settings-smiley-icons-enabled:not(.flexcyon-ensure-plugin-icon) {
  div.setting-item-control {
    div.checkbox-container {
      background-color: var(--color-base-05);
      box-shadow: unset;
      font-weight: bolder;
    }

    div.checkbox-container::after {
      content: ":(";
      transform: translateY(-10%);
      inline-size: fit-content;
      block-size: fit-content;
      background-color: inherit;
      color: var(--color-red);
      box-shadow: unset;
      border-radius: 25%;
    }

    div.checkbox-container.is-enabled::after {
      content: ":)";
      color: var(--color-green);
      transform: translate(16px, -10%);
    }

    input.slider {
      border-radius: unset;
    }
  }
}

@mixin nth-hover-color($color-map: ()) {
  $max-index: 0;

  @each $index, $color in $color-map {
    $max-index: max($max-index, $index);
  }

  $interval: $max-index + 1;

  @each $index, $color in $color-map {
    & :nth-of-type(#{$interval}n + #{$index}):hover {
      color: var(--color-#{$color});
    }
  }
}

body.flexcyon-flex-max-mode div.side-dock-actions,
body.flexcyon-sidedock-icon-effects div.side-dock-actions {
  opacity: var(--dimmed);
  scale: var(--upsize);

  &:hover {
    opacity: 1;
  }

  & :hover {
    scale: var(--expand);
  }

  @include nth-hover-color(
    (
      0: purple,
      1: cyan,
      2: blue,
      3: pink,
      4: green,
      5: yellow,
      6: orange,
      7: red,
    )
  );
}

body.theme-light.flexcyon-settings-comm-item-enabled .community-item-name {
  color: var(--color-yellow);
}

body.flexcyon-flex-max-mode,
body.flexcyon-settings-coloured-icons {
  [aria-label^="Uninstall"] {
    color: rgba(var(--color-red-rgb), 0.9);
  }

  [aria-label^="Options"] {
    color: rgba(var(--color-blue-rgb), 0.9);
  }

  [aria-label^="Customise this command"],
  [aria-label^="Customize this command"],
  [aria-label^="Hotkeys"],
  [aria-label^="Open snippets folder"],
  [aria-label^="Open plugins folder"] {
    color: rgba(var(--color-green-rgb), 0.9);
  }

  [aria-label^="Donate to support"] {
    color: rgba(var(--color-pink-rgb), 0.9);
  }

  [aria-label^="Reload plugins"],
  [aria-label^="Reload snippets"] {
    color: rgba(var(--color-cyan-rgb), 0.9);
  }

  [aria-label^="Restore default"] {
    color: rgba(var(--color-purple-rgb), 0.9);
  }
}

body.is-mobile .vertical-tab-content {
  background-color: var(--color-base-05);
}

body.flexcyon-workspace-angled-layout {
  .collapse-icon.is-collapsed svg.svg-icon {
    transform: rotate(calc(var(--direction) * -1 * 90deg)) skewX(-5deg);
  }

  .tree-item-self .collapse-icon svg {
    transform: skewX(7.5deg);
  }
}

@mixin ascii-aria-icon($aria-label, $content) {
  [aria-label*="#{$aria-label}"] {
    inline-size: 24px;

    &::after {
      content: "#{$content}";
      font-size: var(--font-ui-small);
      letter-spacing: -0.75px;
    }

    svg {
      opacity: 0;
    }
  }
}

body.flexcyon-ascii-icon-set:not(.flexcyon-ensure-plugin-icon),
body.flexcyon-ascii-icon-set.flexcyon-ensure-plugin-icon:not(
    [class*="iconic"]
  ) {
  .modal-close-button {
    position: absolute;
    inset-inline-end: 2.5%;
    inset-block-start: 16px;
    inline-size: 24px;
    padding-inline-end: 48px;

    &::before {
      opacity: 0;
    }

    &::after {
      content: "x_x";
      font-size: var(--font-ui-small);
    }
  }

  .search-input-container {
    &::before {
      opacity: 0;
    }

    &::after {
      margin: 0 8px;
      content: "?/";
      position: absolute;
      inset-inline-start: 0;
      inset-block-end: 6px;
      font-size: var(--font-ui-small);
    }
  }

  .modal.mod-settings .vertical-tab-content {
    padding-block-start: 48px;
  }

  .iconic-add,
  .iconic-drag,
  .iconic-rule-icon,
  .omnisearch-result__icon,
  .workspace-tab-header-inner-close-button,
  .workspace-left-content[aria-label*="Back"] {
    svg {
      opacity: 0;
    }
  }

  .iconic-rule-icon,
  .iconic-add,
  .iconic-drag,
  .workspace-left-content[aria-label*="Back"] {
    inline-size: 24px;
  }

  .iconic-rule-icon::after {
    content: "./^";
    font-size: var(--font-ui-small);
    letter-spacing: -0.75px;
  }

  .iconic-add::after {
    content: "[~]";
    font-size: var(--font-ui-small);
    letter-spacing: -0.75px;
    transform: translateX(-24px);
    color: var(--color-green);
  }

  .iconic-drag::after {
    content: "|||";
    font-size: var(--font-ui-small);
    letter-spacing: -0.75px;
  }

  .omnisearch-result__icon {
    &:has(.lucide-file)::before {
      content: "''";
      font-size: var(--font-ui-smaller);
      letter-spacing: -2px;
    }

    &:has(.lucide-file-text)::before {
      content: "``";
      font-size: var(--font-ui-smaller);
      letter-spacing: -2px;
    }
  }

  .workspace-left-content[aria-label*="Back"] {
    &::after {
      content: "<";
      font-size: var(--font-ui-small);
      letter-spacing: -0.75px;
    }
  }

  .workspace-tab-header-inner-close-button {
    color: inherit;

    &::after {
      content: "x_x";
      font-size: var(--font-ui-small);
    }
  }

  @include ascii-aria-icon("Uninstall", "*_*");
  @include ascii-aria-icon("Options", "[*]");
  @include ascii-aria-icon("Hotkeys", "[%]");
  @include ascii-aria-icon("Customise this command", "[~]");
  @include ascii-aria-icon("Customize this command", "[~]");
  @include ascii-aria-icon("Export settings", ".>");
  @include ascii-aria-icon("Donate", "<3");
  @include ascii-aria-icon("Reload", "[R]");
  @include ascii-aria-icon("Change sort order", "|'|");
  @include ascii-aria-icon("folder", "./^");
  @include ascii-aria-icon("Restore default", "[0]");
  @include ascii-aria-icon("Reset all settings to default", "[0]");
  @include ascii-aria-icon("New note", "[N]");
  @include ascii-aria-icon("Expand", "[+]");
  @include ascii-aria-icon("Collapse", "[-]");
  @include ascii-aria-icon("Auto-reveal current file", "[>]");
  @include ascii-aria-icon("Auto-scroll to current section", "[>]");
  @include ascii-aria-icon("Show search filter", "?/");
  @include ascii-aria-icon("Bookmark the active tab", "[B]");
  @include ascii-aria-icon("New bookmark group", "{+}");

  [aria-label*="New bookmark group"]::after,
  [aria-label*="Collapse"]::after,
  [aria-label*="Expand"]::after {
    letter-spacing: -2px;
  }

  .nav-buttons-container {
    gap: 6px;
  }

  .search-input-clear-button {
    &::before {
      content: "x_x";
    }

    &::after {
      opacity: 0;
    }
  }
}

body.flexcyon-stylised-pins
  :is(.mod-left-split, .mod-right-split)
  .workspace-tab-header-container-inner {
  .workspace-tab-header-inner-icon
    + div
    + div.workspace-tab-header-status-container {
    inline-size: 0;
  }

  .workspace-tab-header-inner-icon
    + div
    + div.workspace-tab-header-status-container
    .mod-pinned {
    --icon-size: var(--icon-xs);

    transform: translate(-3px, -11px);
    color: var(--color-accent-2);
  }
}

body.flexcyon-stylised-pins.flexcyon-vertical-nav
  :is(.mod-left-split, .mod-right-split)
  .workspace-tab-header-container-inner {
  .workspace-tab-header-inner-icon:has(
    + div + div.workspace-tab-header-status-container > .mod-pinned
  ) {
    transform: translateY(8px);
  }

  .workspace-tab-header-inner-icon
    + div
    + div.workspace-tab-header-status-container
    .mod-pinned {
    --icon-size: var(--icon-xs);

    transform: translate(5px, -22px);
    color: var(--color-accent-2);
  }
}

.mod-root .workspace-tab-header-status-icon {
  color: var(--color-accent-2);
}

body.flexcyon-reverse-tab-header-content .workspace-tab-header-inner {
  flex-direction: row-reverse;
}
